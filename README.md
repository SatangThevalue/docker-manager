# üêã Docker Host Manager

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

**Docker Host Manager** ‡∏Ñ‡∏∑‡∏≠ Service ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏ü‡∏•‡πå `/etc/hosts` ‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Host (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÇ‡∏î‡∏¢‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏Ñ‡∏≠‡∏¢‡∏î‡∏±‡∏Å‡∏ü‡∏±‡∏á Docker Events ‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô Traefik Labels ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏ö Hostname ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì

## üéØ ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ Traefik ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Local Development ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏à‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ:

1.  ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏£‡πâ‡∏≤‡∏á Service ‡πÉ‡∏´‡∏°‡πà (‡πÄ‡∏ä‡πà‡∏ô `whoami`) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î Label `Host('whoami.local')`
2.  ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏õ‡∏¥‡∏î Terminal ‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå `sudo nano /etc/hosts`
3.  ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î `127.0.0.1 whoami.local`
4.  ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏Ñ‡∏∏‡∏ì‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏•‡∏ö‡∏°‡∏±‡∏ô‡∏≠‡∏≠‡∏Å

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì **‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2, 3, ‡πÅ‡∏•‡∏∞ 4** ‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÅ‡∏Ñ‡πà‡∏£‡∏±‡∏ô Container ‡∏ó‡∏µ‡πà‡∏°‡∏µ Label... ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏±‡∏ö

## ‚ú® ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (Features)

* **Auto-Discovery:** ‡∏î‡∏±‡∏Å‡∏ü‡∏±‡∏á Docker `start` ‡πÅ‡∏•‡∏∞ `stop` events ‡πÅ‡∏ö‡∏ö Real-time
* **Traefik-Aware:** ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ Parse ‡∏Å‡∏é `Host("...")` ‡∏à‡∏≤‡∏Å Traefik Labels ‡πÑ‡∏î‡πâ
* **‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢:** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå `/etc/hosts` ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î (‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á `# BEGIN` ‡πÅ‡∏•‡∏∞ `# END`)
* **Health Check:** ‡∏°‡∏µ Endpoint `/health` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ Docker ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ FastAPI ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Docker socket ‡πÑ‡∏î‡πâ)
* **API:** ‡∏°‡∏µ API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (`/`) ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ Host ‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà (`/hosts`)

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

Service ‡∏ô‡∏µ‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô Docker Container ‡πÇ‡∏î‡∏¢‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏Å‡∏≤‡∏£ Mount 2 ‡∏™‡∏¥‡πà‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:

1.  **`/var/run/docker.sock` (Read-only):** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏î‡∏±‡∏Å‡∏ü‡∏±‡∏á Docker Events
2.  **`/etc/hosts` (Read-Write):** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Hostname ‡∏•‡∏á‡πÑ‡∏õ (Mount ‡∏°‡∏≤‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà `/app/hosts.file` ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô Container)

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ Container **Start**:
* Service ‡∏à‡∏∞ Scan Labels ‡∏Ç‡∏≠‡∏á Container ‡∏ô‡∏±‡πâ‡∏ô
* ‡∏´‡∏≤‡∏Å‡∏û‡∏ö `Host(...)` ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏î‡∏∂‡∏á Hostname ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
* ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞ Scan Container ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå `/etc/hosts` ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ Container **Stop**:
* Service ‡∏à‡∏∞ Scan Container ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå `/etc/hosts` ‡πÉ‡∏´‡∏°‡πà

## üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Installation)

1.  **Clone ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ:**
    ```bash
    git clone [https://github.com/YOUR-USERNAME/docker-host-manager.git](https://github.com/YOUR-USERNAME/docker-host-manager.git)
    cd docker-host-manager
    ```

2.  **‡∏£‡∏±‡∏ô Service:**
    ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå `docker-compose.yml` ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ:

    ```yaml
    # docker-compose.yml
    version: "3.8"

    services:
      host-manager:
        build: .
        container_name: host-manager
        restart: unless-stopped
        ports:
          - "8000:8000" # ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö API
        environment:
          # ‡∏ö‡∏≠‡∏Å‡πÉ‡∏´‡πâ Python ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ
          - HOST_FILE_PATH=/app/hosts.file
        volumes:
          # 1. Mount Docker Socket (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å)
          - "/var/run/docker.sock:/var/run/docker.sock:ro"
    
          # 2. Mount ‡πÑ‡∏ü‡∏•‡πå /etc/hosts ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Host (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å)
          - "/etc/hosts:/app/hosts.file"
        
        # 3. Healthcheck ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß host-manager ‡πÄ‡∏≠‡∏á
        healthcheck:
          test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
          interval: 30s
          timeout: 10s
          retries: 3
          start_period: 15s
    ```

    ‡∏™‡∏±‡πà‡∏á‡∏£‡∏±‡∏ô:
    ```bash
    docker-compose up -d
    ```

3.  **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Log (Optional):**
    ```bash
    docker logs -f host-manager
    ```
    ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô Log ‡∏ß‡πà‡∏≤ `‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Docker Daemon ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à` ‡πÅ‡∏•‡∏∞ `üéß ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏±‡∏Å‡∏ü‡∏±‡∏á Docker Events...`

## üïπÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Usage)

‡πÄ‡∏°‡∏∑‡πà‡∏≠ `docker-host-manager` ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏•‡∏≠‡∏á‡∏£‡∏±‡∏ô Container **‡∏≠‡∏∑‡πà‡∏ô** ‡∏ó‡∏µ‡πà‡∏°‡∏µ Traefik Label

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `docker-compose.test.yml`:
```yaml
version: "3.8"
services:
  whoami:
    image: traefik/whoami
    container_name: my-app-whoami
    labels:
      # ‚≠êÔ∏è Label ‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà host-manager ‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô
      - "traefik.http.routers.app1.rule=Host(`whoami.local`,`test.local`)"
```

‡∏£‡∏±‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö:
```bash
docker-compose -f docker-compose.test.yml up -d
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `/etc/hosts` ‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á **Host** (‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏°‡πà) ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:

```
# ... (‡πÑ‡∏ü‡∏•‡πå hosts ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) ...

# BEGIN DYNAMIC HOSTS
127.0.0.1       test.local
127.0.0.1       whoami.local
# END DYNAMIC HOSTS
```

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏™‡∏±‡πà‡∏á `docker-compose -f docker-compose.test.yml down` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÄ‡∏≠‡∏á

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á `docker.sock` ‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå `/etc/hosts` ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å (Root-level access) ‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Host ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

**‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° Local Development ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô**

## üìñ API Endpoints

Service ‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà `http://localhost:8000`

* **`GET /`**:
    ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á Service
* **`GET /health`**:
    Endpoint ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Health Check (‡∏ï‡∏≠‡∏ö `200 OK` ‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥, `503 Service Unavailable` ‡∏ñ‡πâ‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Docker ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)
* **`GET /hosts`**:
    ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ Hostnames ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `/etc/hosts`
* **`POST /refresh`**:
    ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ Service ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Scan Container ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏ü‡∏•‡πå `/etc/hosts` ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

## üìù License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.